{"version":3,"file":"three.interactive.js","sources":["../src/index.js"],"sourcesContent":["import { Raycaster, Vector2 } from 'three';\n\nexport class InteractiveObject {\n  constructor(target, name) {\n    this.target = target;\n    this.name = name;\n    this.intersected = false;\n    this.distance = 0;\n  }\n}\n\nexport class InteractiveEvent {\n  constructor(type, originalEvent = null) {\n    this.cancelBubble = false;\n    this.type = type;\n    this.originalEvent = originalEvent;\n  }\n  stopPropagation() {\n    this.cancelBubble = true;\n  }\n}\n\nexport class InteractionManager {\n  constructor(renderer, camera, domElement, dontBindEventsOnBody) {\n    this.renderer = renderer;\n    this.camera = camera;\n    this.domElement = domElement;\n    this.bindEventsOnBodyElement = true;\n    if (typeof dontBindEventsOnBody !== 'undefined' && dontBindEventsOnBody === true) {\n      this.bindEventsOnBodyElement = false;\n    }\n\n    this.mouse = new Vector2(-1, 1); // top left default position\n\n    this.supportsPointerEvents = !!window.PointerEvent;\n\n    this.interactiveObjects = [];\n\n    this.raycaster = new Raycaster();\n\n    domElement.addEventListener('click', this.onMouseClick);\n\n    if (this.supportsPointerEvents) {\n      if (this.bindEventsOnBodyElement) {\n        domElement.ownerDocument.addEventListener(\n          'pointermove',\n          this.onDocumentMouseMove\n        );\n      } else {\n        domElement.addEventListener(\n          'pointermove',\n          this.onDocumentMouseMove\n        );\n      }\n\n      domElement.addEventListener('pointerdown', this.onMouseDown);\n      domElement.addEventListener('pointerup', this.onMouseUp);\n    } else {\n      if (this.bindEventsOnBodyElement) {\n        domElement.ownerDocument.addEventListener(\n          'mousemove',\n          this.onDocumentMouseMove\n        );\n      } else {\n        domElement.addEventListener(\n          'mousemove',\n          this.onDocumentMouseMove\n        );\n      }\n      domElement.addEventListener('mousedown', this.onMouseDown);\n      domElement.addEventListener('mouseup', this.onMouseUp);\n      domElement.addEventListener('touchstart', this.onTouchStart, {\n        passive: true,\n      });\n      domElement.addEventListener('touchmove', this.onTouchMove, {\n        passive: true,\n      });\n      domElement.addEventListener('touchend', this.onTouchEnd, {\n        passive: true,\n      });\n    }\n\n    this.treatTouchEventsAsMouseEvents = true;\n  }\n\n  dispose = () => {\n    this.domElement.removeEventListener('click', this.onMouseClick);\n\n    if (this.supportsPointerEvents) {\n      this.domElement.ownerDocument.removeEventListener(\n        'pointermove',\n        this.onDocumentMouseMove\n      );\n      this.domElement.removeEventListener('pointerdown', this.onMouseDown);\n      this.domElement.removeEventListener('pointerup', this.onMouseUp);\n    } else {\n      this.domElement.ownerDocument.removeEventListener(\n        'mousemove',\n        this.onDocumentMouseMove\n      );\n      this.domElement.removeEventListener('mousedown', this.onMouseDown);\n      this.domElement.removeEventListener('mouseup', this.onMouseUp);\n      this.domElement.removeEventListener('touchstart', this.onTouchStart);\n      this.domElement.removeEventListener('touchmove', this.onTouchMove);\n      this.domElement.removeEventListener('touchend', this.onTouchEnd);\n    }\n  };\n\n  add = (object, childNames = []) => {\n    if (object) {\n      if (childNames.length > 0) {\n        childNames.forEach((name) => {\n          const o = object.getObjectByName(name);\n          if (o) {\n            const interactiveObject = new InteractiveObject(o, name);\n            this.interactiveObjects.push(interactiveObject);\n          }\n        });\n      } else {\n        const interactiveObject = new InteractiveObject(object, object.name);\n        this.interactiveObjects.push(interactiveObject);\n      }\n    }\n  };\n\n  remove = (object, childNames = []) => {\n    if (object) {\n      if (childNames.length > 0) {\n        const interactiveObjectsNew = [];\n        this.interactiveObjects.forEach((o) => {\n          if (!childNames.includes(o.name)) {\n            interactiveObjectsNew.push(o);\n          }\n        });\n        this.interactiveObjects = interactiveObjectsNew;\n      } else {\n        const interactiveObjectsNew = [];\n        this.interactiveObjects.forEach((o) => {\n          if (o.name !== object.name) {\n            interactiveObjectsNew.push(o);\n          }\n        });\n        this.interactiveObjects = interactiveObjectsNew;\n      }\n    }\n  };\n\n  update = () => {\n    this.raycaster.setFromCamera(this.mouse, this.camera);\n\n    // console.log( scene.children );\n\n    this.interactiveObjects.forEach((object) => {\n      if (object.target) this.checkIntersection(object);\n    });\n\n    this.interactiveObjects.sort(function (a, b) {\n      return a.distance - b.distance;\n    });\n\n    const eventOut = new InteractiveEvent('mouseout');\n    this.interactiveObjects.forEach((object) => {\n      if (!object.intersected && object.wasIntersected) {\n        this.dispatch(object, eventOut);\n      }\n    });\n    const eventOver = new InteractiveEvent('mouseover');\n    this.interactiveObjects.forEach((object) => {\n      if (object.intersected && !object.wasIntersected) {\n        this.dispatch(object, eventOver);\n      }\n    });\n  };\n\n  checkIntersection = (object) => {\n    var intersects = this.raycaster.intersectObjects([object.target], true);\n\n    object.wasIntersected = object.intersected;\n\n    if (intersects.length > 0) {\n      let distance = intersects[0].distance;\n      intersects.forEach((i) => {\n        if (i.distance < distance) {\n          distance = i.distance;\n        }\n      });\n      object.intersected = true;\n      object.distance = distance;\n    } else {\n      object.intersected = false;\n    }\n  };\n\n  onDocumentMouseMove = (mouseEvent) => {\n    // event.preventDefault();\n\n    this.mapPositionToPoint(this.mouse, mouseEvent.clientX, mouseEvent.clientY);\n\n    const event = new InteractiveEvent('mousemove', mouseEvent);\n\n    this.interactiveObjects.forEach((object) => {\n      this.dispatch(object, event);\n    });\n  };\n\n  onTouchMove = (touchEvent) => {\n    // event.preventDefault();\n\n    this.mapPositionToPoint(\n      this.mouse,\n      touchEvent.touches[0].clientX,\n      touchEvent.touches[0].clientY\n    );\n\n    const event = new InteractiveEvent(\n      this.treatTouchEventsAsMouseEvents ? 'mousemove' : 'touchmove',\n      touchEvent\n    );\n\n    this.interactiveObjects.forEach((object) => {\n      this.dispatch(object, event);\n    });\n  };\n\n  onMouseClick = (mouseEvent) => {\n    this.update();\n\n    const event = new InteractiveEvent('click', mouseEvent);\n\n    this.interactiveObjects.forEach((object) => {\n      if (object.intersected) {\n        this.dispatch(object, event);\n      }\n    });\n  };\n\n  onMouseDown = (mouseEvent) => {\n    this.mapPositionToPoint(this.mouse, mouseEvent.clientX, mouseEvent.clientY);\n\n    this.update();\n\n    const event = new InteractiveEvent('mousedown', mouseEvent);\n\n    this.interactiveObjects.forEach((object) => {\n      if (object.intersected) {\n        this.dispatch(object, event);\n      }\n    });\n  };\n\n  onTouchStart = (touchEvent) => {\n    this.mapPositionToPoint(\n      this.mouse,\n      touchEvent.touches[0].clientX,\n      touchEvent.touches[0].clientY\n    );\n\n    this.update();\n\n    const event = new InteractiveEvent(\n      this.treatTouchEventsAsMouseEvents ? 'mousedown' : 'touchstart',\n      touchEvent\n    );\n\n    this.interactiveObjects.forEach((object) => {\n      if (object.intersected) {\n        this.dispatch(object, event);\n      }\n    });\n  };\n\n  onMouseUp = (mouseEvent) => {\n    const event = new InteractiveEvent('mouseup', mouseEvent);\n\n    this.interactiveObjects.forEach((object) => {\n      this.dispatch(object, event);\n    });\n  };\n\n  onTouchEnd = (touchEvent) => {\n    this.mapPositionToPoint(\n      this.mouse,\n      touchEvent.touches[0].clientX,\n      touchEvent.touches[0].clientY\n    );\n\n    this.update();\n\n    const event = new InteractiveEvent(\n      this.treatTouchEventsAsMouseEvents ? 'mouseup' : 'touchend',\n      touchEvent\n    );\n\n    this.interactiveObjects.forEach((object) => {\n      this.dispatch(object, event);\n    });\n  };\n\n  dispatch = (object, event) => {\n    if (object.target && !event.cancelBubble) {\n      event.coords = this.mouse;\n      event.distance = object.distance;\n      event.intersected = object.intersected;\n      object.target.dispatchEvent(event);\n    }\n  };\n\n  mapPositionToPoint = (point, x, y) => {\n    let rect;\n\n    // IE 11 fix\n    if (!this.renderer.domElement.parentElement) {\n      rect = {\n        x: 0,\n        y: 0,\n        left: 0,\n        top: 0,\n        width: 0,\n        height: 0,\n      };\n    } else {\n      rect = this.renderer.domElement.getBoundingClientRect();\n    }\n\n    point.x = ((x - rect.left) / rect.width) * 2 - 1;\n    point.y = -((y - rect.top) / rect.height) * 2 + 1;\n  };\n}\n"],"names":["InteractiveObject","target","name","intersected","distance","InteractiveEvent","type","originalEvent","cancelBubble","InteractionManager","renderer","camera","domElement","dontBindEventsOnBody","dispose","removeEventListener","onMouseClick","supportsPointerEvents","ownerDocument","onDocumentMouseMove","onMouseDown","onMouseUp","onTouchStart","onTouchMove","onTouchEnd","add","object","childNames","length","forEach","o","getObjectByName","interactiveObject","interactiveObjects","push","remove","interactiveObjectsNew","includes","update","raycaster","setFromCamera","mouse","checkIntersection","sort","a","b","eventOut","wasIntersected","dispatch","eventOver","intersects","intersectObjects","i","mouseEvent","mapPositionToPoint","clientX","clientY","event","touchEvent","touches","treatTouchEventsAsMouseEvents","coords","dispatchEvent","point","x","y","rect","parentElement","left","top","width","height","getBoundingClientRect","bindEventsOnBodyElement","Vector2","window","PointerEvent","Raycaster","addEventListener","passive"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;MAEaA,iBAAb,GACE,2BAAYC,MAAZ,EAAoBC,IAApB,EAA0B;EAAA;;EACxB,OAAKD,MAAL,GAAcA,MAAd;EACA,OAAKC,IAAL,GAAYA,IAAZ;EACA,OAAKC,WAAL,GAAmB,KAAnB;EACA,OAAKC,QAAL,GAAgB,CAAhB;EACD;MAGUC,gBAAb;EACE,4BAAYC,IAAZ,EAAwC;EAAA,QAAtBC,aAAsB,uEAAN,IAAM;;EAAA;;EACtC,SAAKC,YAAL,GAAoB,KAApB;EACA,SAAKF,IAAL,GAAYA,IAAZ;EACA,SAAKC,aAAL,GAAqBA,aAArB;EACD;;EALH;EAAA;EAAA,sCAMoB;EAChB,WAAKC,YAAL,GAAoB,IAApB;EACD;EARH;;EAAA;EAAA;MAWaC,kBAAb,GACE,4BAAYC,QAAZ,EAAsBC,MAAtB,EAA8BC,UAA9B,EAA0CC,oBAA1C,EAAgE;EAAA;;EAAA;;EAAA,OA8DhEC,OA9DgE,GA8DtD,YAAM;EACd,IAAA,KAAI,CAACF,UAAL,CAAgBG,mBAAhB,CAAoC,OAApC,EAA6C,KAAI,CAACC,YAAlD;;EAEA,QAAI,KAAI,CAACC,qBAAT,EAAgC;EAC9B,MAAA,KAAI,CAACL,UAAL,CAAgBM,aAAhB,CAA8BH,mBAA9B,CACE,aADF,EAEE,KAAI,CAACI,mBAFP;;EAIA,MAAA,KAAI,CAACP,UAAL,CAAgBG,mBAAhB,CAAoC,aAApC,EAAmD,KAAI,CAACK,WAAxD;;EACA,MAAA,KAAI,CAACR,UAAL,CAAgBG,mBAAhB,CAAoC,WAApC,EAAiD,KAAI,CAACM,SAAtD;EACD,KAPD,MAOO;EACL,MAAA,KAAI,CAACT,UAAL,CAAgBM,aAAhB,CAA8BH,mBAA9B,CACE,WADF,EAEE,KAAI,CAACI,mBAFP;;EAIA,MAAA,KAAI,CAACP,UAAL,CAAgBG,mBAAhB,CAAoC,WAApC,EAAiD,KAAI,CAACK,WAAtD;;EACA,MAAA,KAAI,CAACR,UAAL,CAAgBG,mBAAhB,CAAoC,SAApC,EAA+C,KAAI,CAACM,SAApD;;EACA,MAAA,KAAI,CAACT,UAAL,CAAgBG,mBAAhB,CAAoC,YAApC,EAAkD,KAAI,CAACO,YAAvD;;EACA,MAAA,KAAI,CAACV,UAAL,CAAgBG,mBAAhB,CAAoC,WAApC,EAAiD,KAAI,CAACQ,WAAtD;;EACA,MAAA,KAAI,CAACX,UAAL,CAAgBG,mBAAhB,CAAoC,UAApC,EAAgD,KAAI,CAACS,UAArD;EACD;EACF,GAnF+D;;EAAA,OAqFhEC,GArFgE,GAqF1D,UAACC,MAAD,EAA6B;EAAA,QAApBC,UAAoB,uEAAP,EAAO;;EACjC,QAAID,MAAJ,EAAY;EACV,UAAIC,UAAU,CAACC,MAAX,GAAoB,CAAxB,EAA2B;EACzBD,QAAAA,UAAU,CAACE,OAAX,CAAmB,UAAC3B,IAAD,EAAU;EAC3B,cAAM4B,CAAC,GAAGJ,MAAM,CAACK,eAAP,CAAuB7B,IAAvB,CAAV;;EACA,cAAI4B,CAAJ,EAAO;EACL,gBAAME,iBAAiB,GAAG,IAAIhC,iBAAJ,CAAsB8B,CAAtB,EAAyB5B,IAAzB,CAA1B;;EACA,YAAA,KAAI,CAAC+B,kBAAL,CAAwBC,IAAxB,CAA6BF,iBAA7B;EACD;EACF,SAND;EAOD,OARD,MAQO;EACL,YAAMA,iBAAiB,GAAG,IAAIhC,iBAAJ,CAAsB0B,MAAtB,EAA8BA,MAAM,CAACxB,IAArC,CAA1B;;EACA,QAAA,KAAI,CAAC+B,kBAAL,CAAwBC,IAAxB,CAA6BF,iBAA7B;EACD;EACF;EACF,GApG+D;;EAAA,OAsGhEG,MAtGgE,GAsGvD,UAACT,MAAD,EAA6B;EAAA,QAApBC,UAAoB,uEAAP,EAAO;;EACpC,QAAID,MAAJ,EAAY;EACV,UAAIC,UAAU,CAACC,MAAX,GAAoB,CAAxB,EAA2B;EACzB,YAAMQ,qBAAqB,GAAG,EAA9B;;EACA,QAAA,KAAI,CAACH,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACC,CAAD,EAAO;EACrC,cAAI,CAACH,UAAU,CAACU,QAAX,CAAoBP,CAAC,CAAC5B,IAAtB,CAAL,EAAkC;EAChCkC,YAAAA,qBAAqB,CAACF,IAAtB,CAA2BJ,CAA3B;EACD;EACF,SAJD;;EAKA,QAAA,KAAI,CAACG,kBAAL,GAA0BG,qBAA1B;EACD,OARD,MAQO;EACL,YAAMA,sBAAqB,GAAG,EAA9B;;EACA,QAAA,KAAI,CAACH,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACC,CAAD,EAAO;EACrC,cAAIA,CAAC,CAAC5B,IAAF,KAAWwB,MAAM,CAACxB,IAAtB,EAA4B;EAC1BkC,YAAAA,sBAAqB,CAACF,IAAtB,CAA2BJ,CAA3B;EACD;EACF,SAJD;;EAKA,QAAA,KAAI,CAACG,kBAAL,GAA0BG,sBAA1B;EACD;EACF;EACF,GA1H+D;;EAAA,OA4HhEE,MA5HgE,GA4HvD,YAAM;EACb,IAAA,KAAI,CAACC,SAAL,CAAeC,aAAf,CAA6B,KAAI,CAACC,KAAlC,EAAyC,KAAI,CAAC9B,MAA9C,EADa;;;EAKb,IAAA,KAAI,CAACsB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,UAAIA,MAAM,CAACzB,MAAX,EAAmB,KAAI,CAACyC,iBAAL,CAAuBhB,MAAvB;EACpB,KAFD;;EAIA,IAAA,KAAI,CAACO,kBAAL,CAAwBU,IAAxB,CAA6B,UAAUC,CAAV,EAAaC,CAAb,EAAgB;EAC3C,aAAOD,CAAC,CAACxC,QAAF,GAAayC,CAAC,CAACzC,QAAtB;EACD,KAFD;;EAIA,QAAM0C,QAAQ,GAAG,IAAIzC,gBAAJ,CAAqB,UAArB,CAAjB;;EACA,IAAA,KAAI,CAAC4B,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,UAAI,CAACA,MAAM,CAACvB,WAAR,IAAuBuB,MAAM,CAACqB,cAAlC,EAAkD;EAChD,QAAA,KAAI,CAACC,QAAL,CAActB,MAAd,EAAsBoB,QAAtB;EACD;EACF,KAJD;;EAKA,QAAMG,SAAS,GAAG,IAAI5C,gBAAJ,CAAqB,WAArB,CAAlB;;EACA,IAAA,KAAI,CAAC4B,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,UAAIA,MAAM,CAACvB,WAAP,IAAsB,CAACuB,MAAM,CAACqB,cAAlC,EAAkD;EAChD,QAAA,KAAI,CAACC,QAAL,CAActB,MAAd,EAAsBuB,SAAtB;EACD;EACF,KAJD;EAKD,GArJ+D;;EAAA,OAuJhEP,iBAvJgE,GAuJ5C,UAAChB,MAAD,EAAY;EAC9B,QAAIwB,UAAU,GAAG,KAAI,CAACX,SAAL,CAAeY,gBAAf,CAAgC,CAACzB,MAAM,CAACzB,MAAR,CAAhC,EAAiD,IAAjD,CAAjB;;EAEAyB,IAAAA,MAAM,CAACqB,cAAP,GAAwBrB,MAAM,CAACvB,WAA/B;;EAEA,QAAI+C,UAAU,CAACtB,MAAX,GAAoB,CAAxB,EAA2B;EACzB,UAAIxB,QAAQ,GAAG8C,UAAU,CAAC,CAAD,CAAV,CAAc9C,QAA7B;EACA8C,MAAAA,UAAU,CAACrB,OAAX,CAAmB,UAACuB,CAAD,EAAO;EACxB,YAAIA,CAAC,CAAChD,QAAF,GAAaA,QAAjB,EAA2B;EACzBA,UAAAA,QAAQ,GAAGgD,CAAC,CAAChD,QAAb;EACD;EACF,OAJD;EAKAsB,MAAAA,MAAM,CAACvB,WAAP,GAAqB,IAArB;EACAuB,MAAAA,MAAM,CAACtB,QAAP,GAAkBA,QAAlB;EACD,KATD,MASO;EACLsB,MAAAA,MAAM,CAACvB,WAAP,GAAqB,KAArB;EACD;EACF,GAxK+D;;EAAA,OA0KhEgB,mBA1KgE,GA0K1C,UAACkC,UAAD,EAAgB;EACpC;EAEA,IAAA,KAAI,CAACC,kBAAL,CAAwB,KAAI,CAACb,KAA7B,EAAoCY,UAAU,CAACE,OAA/C,EAAwDF,UAAU,CAACG,OAAnE;;EAEA,QAAMC,KAAK,GAAG,IAAIpD,gBAAJ,CAAqB,WAArB,EAAkCgD,UAAlC,CAAd;;EAEA,IAAA,KAAI,CAACpB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,MAAA,KAAI,CAACsB,QAAL,CAActB,MAAd,EAAsB+B,KAAtB;EACD,KAFD;EAGD,GApL+D;;EAAA,OAsLhElC,WAtLgE,GAsLlD,UAACmC,UAAD,EAAgB;EAC5B;EAEA,IAAA,KAAI,CAACJ,kBAAL,CACE,KAAI,CAACb,KADP,EAEEiB,UAAU,CAACC,OAAX,CAAmB,CAAnB,EAAsBJ,OAFxB,EAGEG,UAAU,CAACC,OAAX,CAAmB,CAAnB,EAAsBH,OAHxB;;EAMA,QAAMC,KAAK,GAAG,IAAIpD,gBAAJ,CACZ,KAAI,CAACuD,6BAAL,GAAqC,WAArC,GAAmD,WADvC,EAEZF,UAFY,CAAd;;EAKA,IAAA,KAAI,CAACzB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,MAAA,KAAI,CAACsB,QAAL,CAActB,MAAd,EAAsB+B,KAAtB;EACD,KAFD;EAGD,GAvM+D;;EAAA,OAyMhEzC,YAzMgE,GAyMjD,UAACqC,UAAD,EAAgB;EAC7B,IAAA,KAAI,CAACf,MAAL;;EAEA,QAAMmB,KAAK,GAAG,IAAIpD,gBAAJ,CAAqB,OAArB,EAA8BgD,UAA9B,CAAd;;EAEA,IAAA,KAAI,CAACpB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,UAAIA,MAAM,CAACvB,WAAX,EAAwB;EACtB,QAAA,KAAI,CAAC6C,QAAL,CAActB,MAAd,EAAsB+B,KAAtB;EACD;EACF,KAJD;EAKD,GAnN+D;;EAAA,OAqNhErC,WArNgE,GAqNlD,UAACiC,UAAD,EAAgB;EAC5B,IAAA,KAAI,CAACC,kBAAL,CAAwB,KAAI,CAACb,KAA7B,EAAoCY,UAAU,CAACE,OAA/C,EAAwDF,UAAU,CAACG,OAAnE;;EAEA,IAAA,KAAI,CAAClB,MAAL;;EAEA,QAAMmB,KAAK,GAAG,IAAIpD,gBAAJ,CAAqB,WAArB,EAAkCgD,UAAlC,CAAd;;EAEA,IAAA,KAAI,CAACpB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,UAAIA,MAAM,CAACvB,WAAX,EAAwB;EACtB,QAAA,KAAI,CAAC6C,QAAL,CAActB,MAAd,EAAsB+B,KAAtB;EACD;EACF,KAJD;EAKD,GAjO+D;;EAAA,OAmOhEnC,YAnOgE,GAmOjD,UAACoC,UAAD,EAAgB;EAC7B,IAAA,KAAI,CAACJ,kBAAL,CACE,KAAI,CAACb,KADP,EAEEiB,UAAU,CAACC,OAAX,CAAmB,CAAnB,EAAsBJ,OAFxB,EAGEG,UAAU,CAACC,OAAX,CAAmB,CAAnB,EAAsBH,OAHxB;;EAMA,IAAA,KAAI,CAAClB,MAAL;;EAEA,QAAMmB,KAAK,GAAG,IAAIpD,gBAAJ,CACZ,KAAI,CAACuD,6BAAL,GAAqC,WAArC,GAAmD,YADvC,EAEZF,UAFY,CAAd;;EAKA,IAAA,KAAI,CAACzB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,UAAIA,MAAM,CAACvB,WAAX,EAAwB;EACtB,QAAA,KAAI,CAAC6C,QAAL,CAActB,MAAd,EAAsB+B,KAAtB;EACD;EACF,KAJD;EAKD,GAtP+D;;EAAA,OAwPhEpC,SAxPgE,GAwPpD,UAACgC,UAAD,EAAgB;EAC1B,QAAMI,KAAK,GAAG,IAAIpD,gBAAJ,CAAqB,SAArB,EAAgCgD,UAAhC,CAAd;;EAEA,IAAA,KAAI,CAACpB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,MAAA,KAAI,CAACsB,QAAL,CAActB,MAAd,EAAsB+B,KAAtB;EACD,KAFD;EAGD,GA9P+D;;EAAA,OAgQhEjC,UAhQgE,GAgQnD,UAACkC,UAAD,EAAgB;EAC3B,IAAA,KAAI,CAACJ,kBAAL,CACE,KAAI,CAACb,KADP,EAEEiB,UAAU,CAACC,OAAX,CAAmB,CAAnB,EAAsBJ,OAFxB,EAGEG,UAAU,CAACC,OAAX,CAAmB,CAAnB,EAAsBH,OAHxB;;EAMA,IAAA,KAAI,CAAClB,MAAL;;EAEA,QAAMmB,KAAK,GAAG,IAAIpD,gBAAJ,CACZ,KAAI,CAACuD,6BAAL,GAAqC,SAArC,GAAiD,UADrC,EAEZF,UAFY,CAAd;;EAKA,IAAA,KAAI,CAACzB,kBAAL,CAAwBJ,OAAxB,CAAgC,UAACH,MAAD,EAAY;EAC1C,MAAA,KAAI,CAACsB,QAAL,CAActB,MAAd,EAAsB+B,KAAtB;EACD,KAFD;EAGD,GAjR+D;;EAAA,OAmRhET,QAnRgE,GAmRrD,UAACtB,MAAD,EAAS+B,KAAT,EAAmB;EAC5B,QAAI/B,MAAM,CAACzB,MAAP,IAAiB,CAACwD,KAAK,CAACjD,YAA5B,EAA0C;EACxCiD,MAAAA,KAAK,CAACI,MAAN,GAAe,KAAI,CAACpB,KAApB;EACAgB,MAAAA,KAAK,CAACrD,QAAN,GAAiBsB,MAAM,CAACtB,QAAxB;EACAqD,MAAAA,KAAK,CAACtD,WAAN,GAAoBuB,MAAM,CAACvB,WAA3B;EACAuB,MAAAA,MAAM,CAACzB,MAAP,CAAc6D,aAAd,CAA4BL,KAA5B;EACD;EACF,GA1R+D;;EAAA,OA4RhEH,kBA5RgE,GA4R3C,UAACS,KAAD,EAAQC,CAAR,EAAWC,CAAX,EAAiB;EACpC,QAAIC,IAAJ,CADoC;;EAIpC,QAAI,CAAC,KAAI,CAACxD,QAAL,CAAcE,UAAd,CAAyBuD,aAA9B,EAA6C;EAC3CD,MAAAA,IAAI,GAAG;EACLF,QAAAA,CAAC,EAAE,CADE;EAELC,QAAAA,CAAC,EAAE,CAFE;EAGLG,QAAAA,IAAI,EAAE,CAHD;EAILC,QAAAA,GAAG,EAAE,CAJA;EAKLC,QAAAA,KAAK,EAAE,CALF;EAMLC,QAAAA,MAAM,EAAE;EANH,OAAP;EAQD,KATD,MASO;EACLL,MAAAA,IAAI,GAAG,KAAI,CAACxD,QAAL,CAAcE,UAAd,CAAyB4D,qBAAzB,EAAP;EACD;;EAEDT,IAAAA,KAAK,CAACC,CAAN,GAAW,CAACA,CAAC,GAAGE,IAAI,CAACE,IAAV,IAAkBF,IAAI,CAACI,KAAxB,GAAiC,CAAjC,GAAqC,CAA/C;EACAP,IAAAA,KAAK,CAACE,CAAN,GAAU,EAAE,CAACA,CAAC,GAAGC,IAAI,CAACG,GAAV,IAAiBH,IAAI,CAACK,MAAxB,IAAkC,CAAlC,GAAsC,CAAhD;EACD,GA/S+D;;EAC9D,OAAK7D,QAAL,GAAgBA,QAAhB;EACA,OAAKC,MAAL,GAAcA,MAAd;EACA,OAAKC,UAAL,GAAkBA,UAAlB;EACA,OAAK6D,uBAAL,GAA+B,IAA/B;;EACA,MAAI,OAAO5D,oBAAP,KAAgC,WAAhC,IAA+CA,oBAAoB,KAAK,IAA5E,EAAkF;EAChF,SAAK4D,uBAAL,GAA+B,KAA/B;EACD;;EAED,OAAKhC,KAAL,GAAa,IAAIiC,aAAJ,CAAY,CAAC,CAAb,EAAgB,CAAhB,CAAb,CAT8D;;EAW9D,OAAKzD,qBAAL,GAA6B,CAAC,CAAC0D,MAAM,CAACC,YAAtC;EAEA,OAAK3C,kBAAL,GAA0B,EAA1B;EAEA,OAAKM,SAAL,GAAiB,IAAIsC,eAAJ,EAAjB;EAEAjE,EAAAA,UAAU,CAACkE,gBAAX,CAA4B,OAA5B,EAAqC,KAAK9D,YAA1C;;EAEA,MAAI,KAAKC,qBAAT,EAAgC;EAC9B,QAAI,KAAKwD,uBAAT,EAAkC;EAChC7D,MAAAA,UAAU,CAACM,aAAX,CAAyB4D,gBAAzB,CACE,aADF,EAEE,KAAK3D,mBAFP;EAID,KALD,MAKO;EACLP,MAAAA,UAAU,CAACkE,gBAAX,CACE,aADF,EAEE,KAAK3D,mBAFP;EAID;;EAEDP,IAAAA,UAAU,CAACkE,gBAAX,CAA4B,aAA5B,EAA2C,KAAK1D,WAAhD;EACAR,IAAAA,UAAU,CAACkE,gBAAX,CAA4B,WAA5B,EAAyC,KAAKzD,SAA9C;EACD,GAfD,MAeO;EACL,QAAI,KAAKoD,uBAAT,EAAkC;EAChC7D,MAAAA,UAAU,CAACM,aAAX,CAAyB4D,gBAAzB,CACE,WADF,EAEE,KAAK3D,mBAFP;EAID,KALD,MAKO;EACLP,MAAAA,UAAU,CAACkE,gBAAX,CACE,WADF,EAEE,KAAK3D,mBAFP;EAID;;EACDP,IAAAA,UAAU,CAACkE,gBAAX,CAA4B,WAA5B,EAAyC,KAAK1D,WAA9C;EACAR,IAAAA,UAAU,CAACkE,gBAAX,CAA4B,SAA5B,EAAuC,KAAKzD,SAA5C;EACAT,IAAAA,UAAU,CAACkE,gBAAX,CAA4B,YAA5B,EAA0C,KAAKxD,YAA/C,EAA6D;EAC3DyD,MAAAA,OAAO,EAAE;EADkD,KAA7D;EAGAnE,IAAAA,UAAU,CAACkE,gBAAX,CAA4B,WAA5B,EAAyC,KAAKvD,WAA9C,EAA2D;EACzDwD,MAAAA,OAAO,EAAE;EADgD,KAA3D;EAGAnE,IAAAA,UAAU,CAACkE,gBAAX,CAA4B,UAA5B,EAAwC,KAAKtD,UAA7C,EAAyD;EACvDuD,MAAAA,OAAO,EAAE;EAD8C,KAAzD;EAGD;;EAED,OAAKnB,6BAAL,GAAqC,IAArC;EACD;;;;;;;;;;;;"}